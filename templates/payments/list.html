{% extends "base.html" %}
{% block content %}
<div class="level">
    <div class="level-left">
        <h1 class="title">Payments</h1>
    </div>
    <div class="level-right">
        <a href="{% url 'payment_create' %}" class="button is-primary">Record Payment</a>
    </div>
</div>
<form method="get" class="box">
    <div class="columns">
        <div class="column">
            <label class="label">Client</label>
            <div class="select is-fullwidth">
                <select name="client">
                    <option value="">All clients</option>
                    {% for client in clients %}
                        <option value="{{ client.id }}" {% if client.id|stringformat:'s' == selected_client %}selected{% endif %}>{{ client.company_name }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        <div class="column">
            <label class="label">Start date</label>
            <input class="input" type="date" name="start_date" value="{{ start_date }}">
        </div>
        <div class="column">
            <label class="label">End date</label>
            <input class="input" type="date" name="end_date" value="{{ end_date }}">
        </div>
        <div class="column is-narrow">
            <label class="label">&nbsp;</label>
            <button class="button is-info" type="submit">Filter</button>
        </div>
    </div>
</form>
<table class="table is-fullwidth is-striped">
    <thead>
    <tr>
        <th>Client</th>
        <th>Subscription</th>
        <th>Amount</th>
        <th>Date</th>
        <th>Method</th>
        <th>Status</th>
    </tr>
    </thead>
    <tbody>
    {% for payment in payments %}
        <tr>
            <td>{{ payment.subscription.client.company_name }}</td>
            <td>{{ payment.subscription.plan.name }}</td>
            <td>{{ payment.amount }}</td>
            <td>{{ payment.payment_date }}</td>
            <td>{{ payment.get_payment_method_display }}</td>
            <td>{{ payment.get_status_display }}</td>
        </tr>
    {% empty %}
        <tr><td colspan="6">No payments found.</td></tr>
    {% endfor %}
    </tbody>
</table>
{% endblock %}
